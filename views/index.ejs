<% layout('layout.ejs') %>

<div id="search-wrapper">
  <form id='search-form'>
    <input name='query' type='text' autofocus autocomplete='off' placeholder='Search for music'>
  </form>
  <div id='search-menu'></div>
</div>

<div id='newsfeed-wrapper'></div>
  <div id='pending-newsfeed'></div>
  <div id='newsfeed'></div>

<script type='text/x-handlebars-template' id='search-results-template'>
  {{#unless results}}
  <div class="no-result">
    <p class="no-result-label">
      No Results found.
    </p>
  </div>
  {{else}}
  {{#each results}}
  <div class="result" api='{{api}}' title='{{title}}' src='{{src}}'>
    <img class='icon' src='img/{{api}}-icon.png'>
    <p class="result-label">
     {{title}}
    </p>
  </div>
  {{/each}}
  {{/unless}}
</script>

<script type='text/x-handlebars-template' id='newsfeed-post-template'>
  {{#if pending}}
  <div class="newsfeed-post pending-post">
    <form>
      <iframe type='text/html' width='100%' height='80px' frameborder='0' src='{{post.src}}'/>
      <button type='submit' name='post' value='Post'>
        <i class="glyphicon glyphicon-ok"></i>
      </button>
      <button type='button' name='cancel' value='Cancel'>
        <i class="glyphicon glyphicon-remove"></i>
      </button>
    </form>
  </div>
  {{else}}
  <div class="newsfeed-post">
    <div id='{{post.id}}' />
    <iframe type='text/html' width='100%' height='80px' frameborder='0' src='{{post.src}}'/>
    <p class='upvotes'>{{post.upvotes}}</p>
    <button type='button' name='upvote' value='Upvote'>
      <i class="glyphicon glyphicon-chevron-up"></i>
    </button>
    <button type='button' name='remove' value='Remove'>
      <i class="glyphicon glyphicon-remove"></i>
    </button>
  </div>
  {{/if}}
</script>

<!-- Libraries -->
<script src='js/lib/jquery.min.js'></script>
<script src='js/lib/bootstrap.min.js'></script>
<script src='js/lib/handlebars.js'></script>

<!-- Utilities -->
<script src='js/util.js'></script>

<!-- Models -->
<script src='js/newsfeed-model.js'></script>
<script src='js/search-model.js'></script>

<!-- Views -->
<script src='js/main-view.js'></script>
<script src='js/newsfeed-view.js'></script>
<script src='js/search-view.js'></script>
<script src='js/pending-post-view.js'></script>

<!-- Main -->
<script src='js/main.js'></script>
